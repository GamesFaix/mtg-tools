# Archivist

Archivist is a CLI for Magic: the Gathering inventory management.

## Usage

### Create a workspace

First set a workspace directory.
This is the folder where all your Archivist files will go.

```powershell
rcvst workspace C:\Users\C.Nalar\Documents\Archivist
```

> This should create the `/transactions` folder

You can check the current workspace with:

```powershell
rcvst workspace
Workspace is currently set to C:\Users\C.Nalar\Documents\Archivist.
```

Add files for transactions to the `transactions` folder. CSV's can be generated by many mobile scanning apps. `manifest.json` files should be hand written.

> TODO: Use yml for manifest files for readability

### Calculate your current inventory

```powershell
rcvst run
```

> This will sum all transactions to generate `inventory/current/cards.csv`, and `inventory/current/manifest.json` with metadata about when the inventory was generated and with which transactions.

## Workspace structure

```
C:\Users\C.Nalar\Documents\Archivist
|- inventory
   | current
     | manifest.json
     | cards.csv
|- transactions
   |- 01-m21-boosters
      |- manifest.json
      |- cards.csv
   |- 02-bulk-lot
      |- manifest.json
      |- cards1.csv
      |- cards2.csv
      |- ...
   |- 03-trade-with-jace
      |- manifest.json
      |- incoming.csv
      |- outgoing.csv
   |- ...
```

### Transactions

A transaction represents a set of cards acquired, lost, or traded together. Each transaction's files are saved in a subfolder of the `transactions/` folder. Transations are numbered in the order they are created.

The current state of the inventory can be calculated by "adding" each transaction together.

Each transaction folder has one `manifest.json` file and one or more `.csv` files.

### `manifest.json`

```json
// 01-m21-boosters/manifest.json
{
    "id": 1,
    "title": "M21 boosters", // required
    "date": "2020-01-02", // required
    "notes": "2x", // optional
    "cost": 8.00, // optional
    "add": [ "cards" ] // optional, but either 'add' or 'remove' required
}
```

```fsharp
type Transaction = {
    Id : int
    Title : string
    Date : DateTime
    Notes : string option
    Cost : Decimal option
    Add : string list
    Remove : string list
}
```

## Card CSV structure

|Count|Name|Set|Foil|No|Lang
|-|-|-|-|-|-|
|2|Lightning bolt|4ED
|1|Gravedigger|7ED|true
|2|Island|STX| |253
|1|Island|STX| |254
|1|Island|STX| |254|Spanish

```fsharp
type Card = {
    Count: int          // required
    Name: string        // required
    Set: string         // required
    Foil: bool          // false if missing
    No: int option      // Only needed to disambiguate alternate art
    Lang: string option // English if None
}
```
